---
- name: Infra
  hosts: all

  roles:
    ###
    ### Requirements
    ###
    - role: ansible-infra-users
      tags:
        - ansible-infra-users
        - ansible-infra

    - role: bertvv.samba
      tags:
        - samba
        - skip_ansible_lint

    - role: geerlingguy.docker
      when: ansible_architecture == "x86_64"
      tags:
        - docker
        - skip_ansible_lint

    - role: geerlingguy.docker_arm
      when: ansible_architecture == "aarch64"
      tags:
        - docker_arm
        - skip_ansible_lint

    ###
    ### Infra Roles
    ###
    - role: ansible-infra-general
      tags:
        - ansible-infra-general
        - ansible-infra

    - role: ansible-infra-docker
      tags:
        - ansible-infra-docker
        - ansible-infra